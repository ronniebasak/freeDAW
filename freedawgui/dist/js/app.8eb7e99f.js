(function(t){function e(e){for(var r,o,s=e[0],c=e[1],u=e[2],l=0,d=[];l<s.length;l++)o=s[l],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&d.push(a[o][0]),a[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);h&&h(e);while(d.length)d.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],r=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(r=!1)}r&&(i.splice(e--,1),t=s(s.s=n[0]))}return t}var r={},a={app:0},i=[];function o(t){return s.p+"js/"+({about:"about"}[t]||t)+"."+{about:"70a1a2a0"}[t]+".js"}function s(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(t){var e=[],n=a[t];if(0!==n)if(n)e.push(n[2]);else{var r=new Promise((function(e,r){n=a[t]=[e,r]}));e.push(n[2]=r);var i,c=document.createElement("script");c.charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.src=o(t);var u=new Error;i=function(e){c.onerror=c.onload=null,clearTimeout(l);var n=a[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src;u.message="Loading chunk "+t+" failed.\n("+r+": "+i+")",u.name="ChunkLoadError",u.type=r,u.request=i,n[1](u)}a[t]=void 0}};var l=setTimeout((function(){i({type:"timeout",target:c})}),12e4);c.onerror=c.onload=i,document.head.appendChild(c)}return Promise.all(e)},s.m=t,s.c=r,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(n,r,function(e){return t[e]}.bind(null,r));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/",s.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var h=u;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},1:function(t,e){},2:function(t,e){},3:function(t,e){},4:function(t,e){},5:function(t,e){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("div",{staticStyle:{"font-size":"large",color:"white","margin-top":"15px"}},[t._v("Sohan's Chromatic Tuner")]),n("router-view")],1)},i=[],o=(n("5c0b"),n("2877")),s={},c=Object(o["a"])(s,a,i,!1,null,null,null),u=c.exports,l=(n("d3b7"),n("8c4f")),h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},[n("div",{staticClass:"leftpanel"},[n("div",{staticClass:"volumeknob lg"},[n("div",{staticClass:"bachha",style:{height:300-Math.abs(t.decibels)+"px","margin-top":Math.abs(t.decibels)+"px"}}),n("div",{staticClass:"meter"},[t._v(" "+t._s(Math.round(100*t.decibels,2)/100)+" "),n("br"),t._v(" dBFS ")]),n("div",{staticClass:"meterKaBhai",style:{top:60+Math.abs(t.thresh)+"px"}})]),n("div",{staticClass:"lg",staticStyle:{color:"white","margin-top":"15px"}},[t._v(" Adjust Threshold for Detection "),n("br"),n("input",{directives:[{name:"model",rawName:"v-model",value:t.thresh,expression:"thresh"}],attrs:{type:"range",min:"-300",max:"0"},domProps:{value:t.thresh},on:{__r:function(e){t.thresh=e.target.value}}})])]),n("div",{staticClass:"centerpanel"},[n("canvas",{ref:"tuner",attrs:{id:"tuner",width:"640",height:"480"},on:{click:t.coolcul}}),n("div",{staticStyle:{color:"white","font-size":"25pt"}},[t._v(" "+t._s(Math.round(100*t.freq)/100)+" Hz ")]),n("div",{staticStyle:{color:"white","font-size":"20pt"}},[t._v(" "+t._s(t.note.note)+t._s(t.note.octave)+" ")]),t.init?t._e():n("div",{staticStyle:{color:"#00adff","font-size":"25pt"}},[t._v("Click/Tap on the dial to begin")])]),n("div",{staticClass:"rightpanel"},[n("div",{staticClass:"volumeknob sm"},[n("div",{staticClass:"bachha",style:{width:360-Math.abs(t.decibels)+"px","margin-right":Math.abs(t.decibels)+"px"}}),n("div",{staticClass:"meterKaBhai",style:{left:360-1.2*Math.abs(t.thresh)+"px"}}),n("div",{staticClass:"meter"},[t._v(" "+t._s(Math.round(100*t.decibels,2)/100)+" "),n("br"),t._v(" dBFS ")])]),n("div",{staticClass:"sm",staticStyle:{color:"white","margin-top":"15px"}},[t._v(" Adjust Threshold for Detection "),n("br"),n("input",{directives:[{name:"model",rawName:"v-model",value:t.thresh,expression:"thresh"}],attrs:{type:"range",min:"-300",max:"0"},domProps:{value:t.thresh},on:{__r:function(e){t.thresh=e.target.value}}})])])])},d=[],f=(n("cb29"),n("2909")),p=(n("96cf"),n("1da1")),v=(n("25f0"),n("cfc3"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("d4ec")),g=function t(e){Object(v["a"])(this,t),this._array=new Float32Array(e),this.length=0,this.alloc=e};g.prototype.toString=function(){return"[object CircularBuffer("+this._array.length+") length "+this.length+"]"},g.prototype.get=function(t){if(!(t<0||t<this.length-this._array.length)){if(t>=this.length)throw new Error("Index Out of Bounds");return this._array[t%this._array.length]}},g.prototype.set=function(t,e){if(t<0||t<this.length-this._array.length)throw new Error("Index Out of bounds");while(t>this.length)this._array[this.length%this._array.length]=void 0,this.length++;this._array[t%this._array.length]=e,t==this.length&&this.length++},g.prototype.push=function(t){this._array[this.length%this._array.length]=t,this.length++},g.prototype.IndexError={};var m=g,b=n("9399"),y=window.AudioContext||window.webkitAudioContext;y.sampleRate=512;var w,x=new y,C=!1,_=null,S=new m(32),M=0,k=function(){var t=Object(p["a"])(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=x.createMediaStreamSource(e),t.next=3,x.audioWorklet.addModule("/audioWorker.js");case 3:w=new AudioWorkletNode(x,"audioWorker"),n.connect(w),w.connect(x.destination),_=b.default("./model/",x,e,j),w.port.onmessage=function(t){M=t.data};case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();function j(){_&&_.getPitch((function(t,e){e&&(!0,console.log("FREQ",e),S.push(e),e,!1)}))}function O(){x.resume(),C?x.suspend():(navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(k),C=!0)}function A(){j();for(var t=0,e=Math.max(0,S.length-S.alloc);e<S.length;e++)t+=S.get(e);return t/=Math.min(S.length,S.alloc),t}function P(){return M}function T(t){t}for(var R={init:O,analyzer:A,setLoudnessThreshold:T,getloudNess:P},E=(n("90d7"),440),q=["A","A#","B","C","C#","D","D#","E","F","F#","G","G#"],D={},B=0;B<12;B++)D[q[B]]=E*Math.pow(2,B);function F(t){var e=q.length*Math.log2(t/E);return e}function N(t){var e=Math.round(t),n=t-e;return n=100*n|0,{semis:e,cents:n}}function z(t){var e=t.semis,n=t.cents,r=e<0?q[q.length- -e%q.length]:q[e%q.length],a=4+e/q.length|0;return{note:r,octave:a,cents:n}}function G(t){var e=F(t),n=N(e),r=z(n);return r}function W(t){E=t}var H={calculateNearestNote:G,setAFreq:W};function I(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4?arguments[4]:void 0;t-=n,e-=r;var i=Math.cos(a),o=Math.sin(a);return[t*i-e*o+n,t*o+e*i+r]}var L={name:"Home",data:function(){return{dataArray:void 0,freq:0,note:{note:"A",octave:"4",cents:0},canvas:void 0,ctx:void 0,decibels:0,init:!1,thresh:-75,selectedTuning:"free",tunings:[{label:"free",modes:[]},{label:"Guitar Standard",modes:["E2","A2","D3","G3","B3","E4"]}]}},components:{},methods:{coolcul:function(){this.init=!this.init,R.init(),this.updater()},drawDial:function(){var t=this.canvas,e=this.ctx,n=e.createLinearGradient(0,0,t.width,0);n.addColorStop(0,"transparent"),n.addColorStop(.3,"rgba(255,100,100,0.2)"),n.addColorStop(.5,"rgba(100,".concat(155+this.note.cents,",100,0.7)")),n.addColorStop(.7,"rgba(255,100,100,0.2)"),n.addColorStop(1,"transparent"),e.strokeStyle=n,e.lineWidth=40,e.beginPath(),e.arc(t.width/2,t.height-50,250,Math.PI,0),e.stroke()},drawHand:function(){var t=this.canvas,e=this.ctx,n=t.width/2,r=t.height-50,a=e.createRadialGradient(n,r,0,n,r,200);a.addColorStop(0,"transparent"),a.addColorStop(.3,"transparent"),a.addColorStop(1,"white"),e.strokeStyle=a;var i=i||{x:t.width/2,y:t.height-50};e.fillStyle=a,e.beginPath(),e.moveTo(n,r),e.lineTo.apply(e,Object(f["a"])(I(n+20,r,n,r,this.handAngle))),e.lineTo.apply(e,Object(f["a"])(I(n+12,r-200,n,r,this.handAngle))),e.lineTo.apply(e,Object(f["a"])(I(n-12,r-200,n,r,this.handAngle))),e.lineTo.apply(e,Object(f["a"])(I(n-20,r,n,r,this.handAngle))),e.closePath(),e.fill()},updater:function(){this.freq=R.analyzer(),this.decibels=R.getloudNess(),this.note=H.calculateNearestNote(this.freq),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawHand(),this.drawDial(),requestAnimationFrame(this.updater)}},computed:{handAngle:function(){return this.note.cents/100*Math.PI}},watch:{thresh:function(t){R.setLoudnessThreshold(t)}},mounted:function(){this.canvas=this.$refs.tuner,this.ctx=this.canvas.getContext("2d"),this.updater()}},$=L,U=(n("b910"),Object(o["a"])($,h,d,!1,null,"73aed806",null)),J=U.exports;r["a"].use(l["a"]);var K=[{path:"/",name:"Home",component:J},{path:"/about",name:"About",component:function(){return n.e("about").then(n.bind(null,"ac6c"))}}],Q=new l["a"]({routes:K}),V=Q,X=n("2f62");r["a"].use(X["a"]);var Y=new X["a"].Store({state:{},mutations:{},actions:{},modules:{}});r["a"].config.productionTip=!1,new r["a"]({router:V,store:Y,render:function(t){return t(u)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";var r=n("9c0c"),a=n.n(r);a.a},6:function(t,e){},"8eb2":function(t,e,n){},9399:function(t,e,n){"use strict";n.r(e);n("13d5"),n("fb6a"),n("b680"),n("d3b7"),n("cfc3"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("96cf");var r=n("1da1"),a=n("d4ec"),i=n("bee2"),o=n("a111");function s(t,e){return e&&t.then((function(t){return e(void 0,t),t})).catch((function(t){return e(t),t})),t}o["j"]("webgl").then((function(){alert(o["c"]())}));var c=function(){function t(e,n,r,i){Object(a["a"])(this,t),this.model=e,this.audioContext=n,this.stream=r,this.frequency=null,this.ready=s(this.loadModel(e),i)}return Object(i["a"])(t,[{key:"loadModel",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o["e"]("".concat(e,"/model.json"));case 2:if(this.model=t.sent,!this.audioContext){t.next=8;break}return t.next=6,this.processStream();case 6:t.next=9;break;case 8:throw new Error("Could not access microphone - getUserMedia not available");case 9:return t.abrupt("return",this);case 10:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"processStream",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,n,r,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o["h"]();case 2:e=this.audioContext.createMediaStreamSource(this.stream),n=this.audioContext.sampleRate/16e3*1024,r=4;while(r<n)r*=2;return t.next=8,this.audioContext.audioWorklet.addModule("/pitchDetectionProcessor.js");case 8:a=new AudioWorkletNode(this.audioContext,"pitchDetectionProcessor"),i=this.audioContext.createGain(),i.gain.setValueAtTime(0,this.audioContext.currentTime),e.connect(a),a.connect(i),i.connect(this.audioContext.destination),"running"!==this.audioContext.state&&console.warn("User gesture needed to start AudioContext, please click");case 15:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"processMicrophoneBuffer",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(n){var r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o["h"]();case 2:this.results={},t.resample(n.inputBuffer,(function(t){o["m"]((function(){var e=o["a"](o["d"](0,7180,360),o["l"](1997.379408437619));r.running=!0;var n=o["l"](t.slice(0,1024)),a=o["k"](n,o["f"](n)),i=o["l"](o["i"](a).dataSync()/Math.sqrt(1024)),s=o["b"](a,i),c=s.reshape([1,1024]),u=r.model.predict([c]).reshape([360]),l=u.max().dataSync()[0],h=u.argMax().dataSync()[0];r.results.confidence=l.toFixed(3);var d=Math.max(0,h-4),f=Math.min(360,h+5),p=u.slice([d],[f-d]),v=e.slice([d],[f-d]),g=o["g"](p,v),m=g.dataSync().reduce((function(t,e){return t+e}),0),b=p.dataSync().reduce((function(t,e){return t+e}),0),y=m/b,w=10*Math.pow(2,y/1200),x=l>.5?w:null;r.frequency=x}))}));case 4:case"end":return e.stop()}}),e,this)})));function n(t){return e.apply(this,arguments)}return n}()},{key:"getPitch",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.ready;case 2:return t.next=4,o["h"]();case 4:return n=this.frequency,e&&e(void 0,n),t.abrupt("return",n);case 7:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()}],[{key:"resample",value:function(t,e){for(var n=t.sampleRate%16e3!==0,r=t.sampleRate/16e3,a=t.getChannelData(0),i=new Float32Array(1024),o=0;o<1024;o+=1)if(n){var s=Math.floor(o*r),c=s+1,u=o*r-s;i[o]=(1-u)*a[s]+u*a[c]}else i[o]=a[o*r];e(i)}}]),t}(),u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"./",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return new c(t,e,n,r)};e["default"]=u},"9c0c":function(t,e,n){},b910:function(t,e,n){"use strict";var r=n("8eb2"),a=n.n(r);a.a}});
//# sourceMappingURL=app.8eb7e99f.js.map